## Entity Classification

- **Task**
  - Type: AGGREGATE
  - Evidence: Top-level export (mockTasks = [...])
  - Endpoints: Will create /api/tasks

- **Assignee**
  - Type: AGGREGATE
  - Evidence: Top-level export (mockAssignees = [...])
  - Endpoints: Will create /api/assignees

- **Tag**
  - Type: AGGREGATE
  - Evidence: Top-level export (mockTags = [...])
  - Endpoints: Will create /api/tags

- **Subtask**
  - Type: EMBEDDED
  - Evidence: Nested object in Task.subtasks, no top-level export
  - Endpoints: None (nested data only)

## Data Models

These models reflect the structure of the mock data and will be used for API requests and responses.

```python
from typing import List, Optional
from pydantic import BaseModel

# Assignee Model
class Assignee(BaseModel):
    id: Optional[str] = None # Generated by backend for new items
    name: str
    avatar: str

# Tag Model
class Tag(BaseModel):
    id: Optional[str] = None # Generated by backend for new items
    name: str
    color: str # e.g., "bg-blue-500"

# Subtask Model (Embedded)
class Subtask(BaseModel):
    completed: int
    total: int

# Task Model
class Task(BaseModel):
    id: Optional[str] = None # Generated by backend for new items
    title: str
    description: str
    status: str # Enum: "Backlog", "In Progress", "Review", "Done"
    priority: str # Enum: "Low", "Medium", "High"
    assignee: Assignee # Embedded Assignee object
    dueDate: str # YYYY-MM-DD format
    tags: List[Tag] # List of embedded Tag objects
    subtasks: Subtask # Embedded Subtask object
    created_at: Optional[str] = None # ISO 8601 datetime string, generated by backend

# Request body for creating a Task (id and created_at are optional for creation)
class TaskCreate(BaseModel):
    title: str
    description: str
    status: str
    priority: str
    assignee: Assignee
    dueDate: str
    tags: List[Tag]
    subtasks: Subtask

# Request body for updating a Task (all fields optional for partial update)
class TaskUpdate(BaseModel):
    title: Optional[str] = None
    description: Optional[str] = None
    status: Optional[str] = None
    priority: Optional[str] = None
    assignee: Optional[Assignee] = None
    dueDate: Optional[str] = None
    tags: Optional[List[Tag]] = None
    subtasks: Optional[Subtask] = None
```

## REST API Endpoints

All backend API routes MUST be prefixed with '/api'.

### Tasks

- **GET /api/tasks**
  - Description: Retrieve a list of all tasks. Supports filtering, searching, and pagination.
  - Query Parameters:
    - `status` (optional, str): Filter tasks by status (e.g., "Backlog", "In Progress").
    - `assignee_id` (optional, str): Filter tasks by assignee ID.
    - `tag_id` (optional, str): Filter tasks by tag ID.
    - `search` (optional, str): Search tasks by title or description.
    - `page` (optional, int, default=1): Page number for pagination.
    - `limit` (optional, int, default=10): Number of items per page.
  - Response: `200 OK`, `{ "data": [Task], "total": number, "page": number, "limit": number }`

- **GET /api/tasks/{id}**
  - Description: Retrieve a single task by its ID.
  - Path Parameters: `id` (str)
  - Response: `200 OK`, `{ "data": Task }`

- **POST /api/tasks**
  - Description: Create a new task.
  - Request Body: `TaskCreate` object.
  - Response: `201 Created`, `{ "data": Task }`

- **PUT /api/tasks/{id}**
  - Description: Update an existing task by its ID. Used for drag-and-drop (status update) and general editing.
  - Path Parameters: `id` (str)
  - Request Body: `TaskUpdate` object (partial updates allowed).
  - Response: `200 OK`, `{ "data": Task }`

- **DELETE /api/tasks/{id}**
  - Description: Delete a task by its ID.
  - Path Parameters: `id` (str)
  - Response: `204 No Content`

### Assignees

- **GET /api/assignees**
  - Description: Retrieve a list of all assignees.
  - Query Parameters:
    - `page` (optional, int, default=1): Page number for pagination.
    - `limit` (optional, int, default=10): Number of items per page.
  - Response: `200 OK`, `{ "data": [Assignee], "total": number, "page": number, "limit": number }`

- **GET /api/assignees/{id}**
  - Description: Retrieve a single assignee by its ID.
  - Path Parameters: `id` (str)
  - Response: `200 OK`, `{ "data": Assignee }`

- **POST /api/assignees**
  - Description: Create a new assignee.
  - Request Body: `Assignee` object (without `id`).
  - Response: `201 Created`, `{ "data": Assignee }`

- **PUT /api/assignees/{id}**
  - Description: Update an existing assignee by its ID.
  - Path Parameters: `id` (str)
  - Request Body: `Assignee` object (partial updates allowed).
  - Response: `200 OK`, `{ "data": Assignee }`

- **DELETE /api/assignees/{id}**
  - Description: Delete an assignee by its ID.
  - Path Parameters: `id` (str)
  - Response: `204 No Content`

### Tags

- **GET /api/tags**
  - Description: Retrieve a list of all tags.
  - Query Parameters:
    - `page` (optional, int, default=1): Page number for pagination.
    - `limit` (optional, int, default=10): Number of items per page.
  - Response: `200 OK`, `{ "data": [Tag], "total": number, "page": number, "limit": number }`

- **GET /api/tags/{id}**
  - Description: Retrieve a single tag by its ID.
  - Path Parameters: `id` (str)
  - Response: `200 OK`, `{ "data": Tag }`

- **POST /api/tags**
  - Description: Create a new tag.
  - Request Body: `Tag` object (without `id`).
  - Response: `201 Created`, `{ "data": Tag }`

- **PUT /api/tags/{id}**
  - Description: Update an existing tag by its ID.
  - Path Parameters: `id` (str)
  - Request Body: `Tag` object (partial updates allowed).
  - Response: `200 OK`, `{ "data": Tag }`

- **DELETE /api/tags/{id}**
  - Description: Delete a tag by its ID.
  - Path Parameters: `id` (str)
  - Response: `204 No Content`

## Response & Error Format (MUST FOLLOW)

- Successful list responses:
  - 200 OK
  - Body:
    {
      "data": [<Entity>],
      "total": number,
      "page": number,
      "limit": number
    }

- Successful single-item responses:
  - 200 OK or 201 Created
  - Body:
    { "data": <Entity> }

- Error responses:
  - 4xx / 5xx
  - Body:
    {
      "error": {
        "code": "<MACHINE_READABLE_CODE>",
        "message": "<Human readable message>",
        "details": optional
      }
    }

This format MUST be consistent across all endpoints.
Routers and tests will rely on it.

## Integration Notes

1.  **Frontend API Client (`frontend/src/lib/api.js`)**: The frontend will use a centralized API client to interact with these endpoints. It will be updated to send requests to `import.meta.env.VITE_API_URL/api/...`.
2.  **Mock Data Replacement**: All usage of `mockTasks`, `mockAssignees`, and `mockTags` in frontend components (e.g., `Home.jsx`, `TasksPage.jsx`) will be replaced with actual API calls.
3.  **Data Fetching & State Management**: The frontend is expected to use TanStack Query for efficient data fetching, caching, and state management, handling loading, error, and success states gracefully.
4.  **Error Handling**: Frontend will parse error responses based on the specified `error` format and display appropriate user feedback.
5.  **Pagination & Filtering**: Frontend components will pass `page`, `limit`, `status`, `assignee_id`, `tag_id`, and `search` query parameters to the `/api/tasks` endpoint to support the required features.
6.  **Task Status Update**: Drag-and-drop functionality will trigger a `PUT /api/tasks/{id}` request to update the `status` field of a task.