// frontend/tests/e2e.spec.js.template
/**
 * E2E Tests Template - Generated from Golden Seed
 * ================================================
 * Luna uses this as a base and customizes it for project-specific tests.
 *
 * This template includes:
 * 1. Smoke test (always passes - page loads)
 * 2. Placeholder CRUD tests for the primary entity
 *
 * To customize:
 * - Replace {{ENTITY}} with the primary entity name (e.g., "expense", "task")
 * - Replace {{ENTITY_PLURAL}} with the plural form (e.g., "expenses", "tasks")
 * - Add entity-specific test cases based on the actual UI components
 */

import { test, expect } from '@playwright/test';

// ═══════════════════════════════════════════════════════
// SMOKE TEST (Always include - validates app is running)
// ═══════════════════════════════════════════════════════

test('page loads without crashing', async ({ page }) => {
  await page.goto('http://localhost:5174/');
  await expect(page).toHaveTitle(/.*/);  // Any title is fine
});

test('shows loading, error, or content state', async ({ page }) => {
  await page.goto('http://localhost:5174/');
  // One of these mutually exclusive states should appear
  await expect(
    page.locator('[data-testid="loading-indicator"]')
      .or(page.locator('[data-testid="error-message"]'))
      .or(page.locator('[data-testid="page-root"]'))
      .or(page.locator('h1, h2').first())
  ).toBeVisible({ timeout: 15000 });
});


// ═══════════════════════════════════════════════════════
// {{ENTITY}} TESTS
// Replace {{ENTITY}}, {{ENTITY_PLURAL}} with actual values
// ═══════════════════════════════════════════════════════

test('main heading is visible', async ({ page }) => {
  await page.goto('http://localhost:5174/');
  await page.waitForLoadState('networkidle');
  
  // Check for any heading (h1 or h2)
  const heading = page.locator('h1, h2').first();
  await expect(heading).toBeVisible({ timeout: 10000 });
});

test('page has content after load', async ({ page }) => {
  await page.goto('http://localhost:5174/');
  await page.waitForLoadState('networkidle');
  
  const error = page.locator('[data-testid="error-message"]');
  const loading = page.locator('[data-testid="loading-indicator"]');
  
  // Only check content if not in error/loading state
  if (await error.isVisible().catch(() => false)) return;
  if (await loading.isVisible().catch(() => false)) return;
  
  // Page should have some visible content
  const pageRoot = page.locator('[data-testid="page-root"]');
  const mainContent = page.locator('main, [role="main"], .container');
  
  await expect(pageRoot.or(mainContent).or(page.locator('h1'))).toBeVisible();
});


// ═══════════════════════════════════════════════════════
// Additional Tests (Uncomment and customize as needed)
// ═══════════════════════════════════════════════════════

// test('create {{ENTITY}} button exists', async ({ page }) => {
//   await page.goto('http://localhost:5174/');
//   await page.waitForLoadState('networkidle');
//   
//   const error = page.locator('[data-testid="error-message"]');
//   if (await error.isVisible().catch(() => false)) return;
//   
//   const createButton = page.locator('[data-testid="create-{{ENTITY}}-button"]')
//     .or(page.getByRole('button', { name: /create|add|new/i }));
//   
//   await expect(createButton.first()).toBeVisible({ timeout: 10000 });
// });

// test('{{ENTITY}} list container exists', async ({ page }) => {
//   await page.goto('http://localhost:5174/');
//   await page.waitForLoadState('networkidle');
//   
//   const error = page.locator('[data-testid="error-message"]');
//   if (await error.isVisible().catch(() => false)) return;
//   
//   // Use toBeAttached for potentially empty containers
//   const list = page.locator('[data-testid="{{ENTITY}}-list"]');
//   await expect(list).toBeAttached({ timeout: 10000 });
// });
